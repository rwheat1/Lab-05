---
title: "Lab 04 - La Quinta is Spanish for next to Denny's, Pt. 2"
author: "Mr. Ryan Wheat"
date: "2/21/23"
output: github_document
---

### Load packages and data

```{r load-packages, message = FALSE}
library(tidyverse) 
library(dsbox) 
```

```{r load-data, message = FALSE}
states <- read_csv("data/states.csv")
dn <- dennys
lq <- laquinta
```

### Exercise 1

There are 3 Dennys locations in Alaska.

```{r dennys-alaska}

dn_ak <- dn %>%
  filter(state == "AK")
nrow(dn_ak)
```


### Exercise 2

There are two La Quinta locations in Alaska.

```{r laquinta-alaska}

lq_ak <- lq %>%
  filter(state == "AK")
nrow(lq_ak)

```

### Exercise 3

We need to calculate six distances, because there are six combinations of distances between each Denny's and La Quinta location in Alaska.

### Exercise 4

There are 6 observations in this dataframe, which match the six combinations we needed. The names of the variables seem to indicate which dataframe they come from -- .x = dn_ak; .y = lq_ak.

```{r join-datasets}

dn_lq_ak <- full_join(dn_ak, lq_ak, by = "state")
dn_lq_ak

```


### Exercise 5

mutate() is the function that will create a new variable while keeping our current variables I think?

### Exercise 6

```{r create-distance-variable}

#create haversine function

haversine <- function(long1, lat1, long2, lat2, round = 3) {
  # convert to radians
  long1 = long1 * pi / 180
  lat1  = lat1  * pi / 180
  long2 = long2 * pi / 180
  lat2  = lat2  * pi / 180
  
  R = 6371 # Earth mean radius in km
  
  a = sin((lat2 - lat1)/2)^2 + cos(lat1) * cos(lat2) * sin((long2 - long1)/2)^2
  d = R * 2 * asin(sqrt(a))
  
  return( round(d,round) ) # distance in km
}

#create new variable "distance"

dn_lq_ak <- dn_lq_ak %>%
  mutate(distance = haversine(dn_lq_ak$longitude.x, dn_lq_ak$latitude.x, dn_lq_ak$longitude.y, dn_lq_ak$latitude.y))

```

### Exercise 7

```{r min-distance}

dn_lq_ak_mindist <- dn_lq_ak %>%
  group_by(address.x) %>%
  summarize(closest = min(distance))

```

### Exercise 8

```{r min-distance-viz}

dn_lq_ak_mindist %>% 
  ggplot(aes(x = closest)) +
  geom_density()

```

...

Add exercise headings as needed.
